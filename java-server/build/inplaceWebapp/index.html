<!DOCTYPE html>
<html>

<head>

    <link rel="stylesheet" href="base.css" media="screen" />
    <link rel="stylesheet" href="desert.css" media="screen" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>
    <script>
        $(document).ready(function () {
            $.get("6502.txt", function (file) {

                var output = "#pretty-pre";
                var mistakes = 0;
                // var splitFile = file.replace(/\n/g, ' ').replace(/\s+/g, ' ').split("");
                var splitFile = file.split("");
                var currentFile;
                var index = 0;
                var ezMode = true;

                function renderOutput() {
                    currentFile = "";
                    for (let i = index; i < splitFile.length; i++) {
                        const element = splitFile[i];
                        currentFile += element;
                    }
                    $(output).html(PR.prettyPrintOne(currentFile));
                }

                renderOutput();

                $(document).keydown(function (e) {
                    typedKey = e.key;
                    actualKey = splitFile[index];
                    if (ezMode) {
                        typedKey = typedKey.toLowerCase();
                        actualKey = actualKey.toLowerCase();
                    }
                    if (typedKey === actualKey) {
                        index++;
                    } else {
                        mistakes++;
                    }
                    if (e.key === ' ' || splitFile[index] === '\n' || splitFile[index] === '\t') {
                        while (splitFile[index] === ' ' || splitFile[index] === '\n' || splitFile[index] === '\t') {
                            index++;
                        }
                    }
                    renderOutput();
                    $("#status-div").text("'" + splitFile[index] + "' '" + e.key + "'");
                });

            });

        });
    </script>
</head>

<body>

    <code id=pretty-pre class="prettyprint lang-c"></a></code>
    <div id=status-div></div>
    </pre>

</body>

</html>